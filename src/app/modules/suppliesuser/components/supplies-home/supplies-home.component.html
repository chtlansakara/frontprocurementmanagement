<mat-toolbar class="nav-bar">

  <!-- Logo -->
  <a routerLink="/suppliesuser/home/dashboard" matTooltip="Go to Dashboard" class="logo-link">
    <img src="/public/LogoSuppliesHeader.svg" alt="logo supplies" class="main-toolbar-logo">
  </a>

  <!-- LEFT NAV LINKS -->
  <div class="nav-links">
    <button routerLink="/suppliesuser/home/requests" mat-button class="main-toolbar-links" routerLinkActive="active"
      matTooltip="Requests">

      <mat-icon>note_add</mat-icon>
      <!-- <mat-icon>assignment</mat-icon> -->
      <span class="link-text">Requests</span>
    </button>

    <button routerLink="/suppliesuser/home/procurement" mat-button class="main-toolbar-links" routerLinkActive="active"
      matTooltip="Procurement">

      <mat-icon>data_thresholding</mat-icon>
      <span class="link-text">Procurement</span>
    </button>

    <button routerLink="/suppliesuser/home/reports" mat-button class="main-toolbar-links" routerLinkActive="active"
      matTooltip="Reports">

      <mat-icon>article</mat-icon>
      <!-- <mat-icon>bar_chart</mat-icon> -->
      <span class="link-text">Reports</span>
    </button>

    <button routerLink="/suppliesuser/home/logs" mat-button class="main-toolbar-links" routerLinkActive="active"
      matTooltip="Audit Logs">

      <mat-icon>browse_gallery</mat-icon>
      <!-- <mat-icon>history</mat-icon> -->
      <span class="link-text">Logs</span>
    </button>
  </div>

  <span class="example-spacer"></span>

  <!-- RIGHT ICON BUTTONS -->
  <div class="example-button-container">

    <button mat-icon-button matTooltip="Contact support" class="main-toolbar-icon-button"
      [matMenuTriggerFor]="supportMenu">
      <mat-icon class="main-toolbar-icon">contact_support</mat-icon>
    </button>
    <mat-menu #supportMenu="matMenu">
      <button mat-menu-item>Send support request</button>
    </mat-menu>

    <button mat-icon-button matTooltip="Notifications" class="main-toolbar-icon-button"
      [matMenuTriggerFor]="notificationMenu" [matBadge]="unreadCount>0 ? unreadCount: null" matBadgeColor="warn"
      matBadgeSize="large" matBadgePosition="above after">
      <mat-icon class="main-toolbar-icon">notifications</mat-icon>
    </button>

    <!-- <button routerLink="/supplies/settings" mat-icon-button matTooltip="Settings" class="main-toolbar-icon-button">
      <mat-icon class="main-toolbar-icon">settings</mat-icon>
    </button> -->

    <button mat-icon-button class="main-toolbar-icon-button" [matMenuTriggerFor]="userUpdateMenu"
      [matTooltip]="loggedUser" matTooltipClass="multi-line-tooltip">
      <mat-icon class="main-toolbar-icon">account_circle</mat-icon>
    </button>
    <mat-menu #userUpdateMenu="matMenu">
      <button mat-menu-item>Update account</button>
      <button mat-menu-item>Change password</button>
    </mat-menu>

    <button routerLink="/login" mat-icon-button matTooltip="Sign out" class="main-toolbar-icon-button"
      (click)="logout()">
      <mat-icon class="main-toolbar-icon">logout</mat-icon>
    </button>

  </div>

</mat-toolbar>

<!-- NOTIFICATION PANEL -->
<mat-menu #notificationMenu="matMenu" xPosition="before" class="notification-menu">

  <!-- Header -->
  <div class="notif-header" (click)="$event.stopPropagation()">
    <span class="notif-title">Notifications</span>
    @if (unreadCount > 0) {
    <button mat-button color="primary" (click)="doMarkAllRead()">
      Mark all read
    </button>
    }
  </div>

  <mat-divider />

  <!-- Notification list -->
  <div class="notif-scroll" (click)="$event.stopPropagation()">
    @for (notif of notifications; track notif.id) {
    <div class="notif-item" [class.unread]="!notif.isRead" (click)="onNotificationClick(notif)">

      <div class="notif-dot" [ngClass]="getDotClass(notif.type)"></div>

      <div class="notif-body">
        <p class="notif-message">{{ notif.message }}</p>
        <p class="notif-time">{{ notif.createdAt | date: 'MMM d, h:mm a' }}</p>
      </div>

      @if (!notif.isRead) {
      <div class="unread-dot"></div>
      }
    </div>
    <mat-divider />
    } @empty {
    <div class="notif-empty">
      <mat-icon>notifications_none</mat-icon>
      <p>No notifications</p>
    </div>
    }
  </div>

</mat-menu>

<div class="container">
  <router-outlet></router-outlet>
</div>


<!-- TOAST CONTAINER â€” fixed to bottom right, outside all other layout -->
<div class="toast-wrapper">
  @for (toast of toastService.toasts(); track toast.id) {
  <div class="toast" [ngClass]="'toast-' + toast.toastType">
    <mat-icon class="toast-icon">{{ getToastIcon(toast.toastType) }}</mat-icon>
    <span class="toast-message">{{ toast.message }}</span>
    <mat-icon class="toast-close" (click)="toastService.dismiss(toast.id)">close</mat-icon>
  </div>
  }
</div>